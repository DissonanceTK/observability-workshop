language: python
os: linux
dist: xenial
if: tag IS present
cache: pip
env:
  global:
  - secure: U6r4b4BZZzLhu73RIKVL4YVncqgzC2GgYuuY7l+Jrc6WuF5L9OhMyEY8aOYWhdqDtvYEMk3iZQOWSxQR1os22Kr8wVM2sLqdZHeybxR/RRFNJ4bfKJwkqabkVBMlHcIjZO3hFqrGa7dVoxj63LOuEzB7qM0ZvcS3VZtFMS/f4Zi6QDzd485VRhv7B03VJ8aVSoHYqMx3gkpRwpAwOcOsrhwCmcEOHAcqMTV/6tt8vVl1jc8sy9YCDNhQmTdm0M2PfiYqv2FCfGJWkXOALjHtrloacgyRJZTwfVdbr/I9sSTN/sdzNv3QFTqErg3c6B+K+HDi61bi+R44ILmOA6wWFOz7nNUBUm1wVXBr5+ENpvQcRKGnIWiJvlCyna0DR7O3hklHFsEw80L5wipg1Xkr9VNflhoYd3RJxNMH7RQgY50KRTyVeIWg9StOQtsANR9wvmYPWT4uf0eGkaAcWfPOwGY+IFe0PzOZH/SByuOj6SG/EHHf9Lz4s2jdSwS/aN6PLvk1gL5TrOZL0v0oGDDzJXH+FJIfYl9FI/3nttJvqhns0yKO6MbXEcHYpZf+S6vlSzy1Pi6jQlgHZXMPE2Aa9EzRYiZXCUMQ4Nehbabbbyu+c2/TKVoWPN/zPCUwmci4J+sYe3/T7wcE/zxTpf0/5URRXurdz0IkhRDrsKZJTk0=
  - secure: X4XbdaQ2hpkfhLL1hE6CPcOI38bbkJZ75320pHH8DiBpUNH2gA5zVJtV/XuHb9m3do9KFwl2B1PghOXI40UstLDijXBz19R0gZ8uWcd2epQCtA+k3KsPB9NVjh4T7DXNly3jmjDdtgelic7Ev/u/+BKtsR46QEOnggfVEWPYmAV3XuIECaoDSP8GNwIg/S+Xq24ywKkvcCryUXA72WJG9o5/82AXrlQi/x/XbKg2YaUVmAmBA5pyZEbaM6paN9CiqAUUoWTyxXabT00dM7lPSYazogZXZwGLrU0/0Bp3Zz6LYbxY/fDRdwkdhU8RAyEUx1ydY2UyjQ/3j50xSTRTsyJdYUiaMKQq/FMUBB77DZGhv99uQMO/qjZ96gMJFOJZdRZUxGcZfnezpSTSG5gGwC2VW7uKFMDwxdxXWqBVYXqOpxEaYToDrGDQewf89LYyP9Z3FUCod+JJRC/OQDbeDIUEmBElE9hXtLXHIi/0HfbiQxlHr+/crpptsMilKzKod5qEakiWHeI7dq1v0RJdYTsVdm+rgdUyeZMuNE/Ka+sDsVzb+5gyN7S3cFXppt0ycrvzF5Athxv5NLSXr0rWRj7YWn9KP9paf9J+fLHbquHn0JEGEvtA55Sg+k/Egs4JEwlaV2Qntb9KievlOETzCx2a/k40NstDmESzuFWyGEw=
  - secure: mTezgNTZAXJB1mM697KwKRk0FCcR/2YQwo/cz3wSRVxK0e7AB8dxVDJu6vy/v+cstkuBxTR1qlu+3yyP+LamVUdHX04ThuYb9JsEHAVixBQAOhm+mAvMt3BIfWlGFFuSACjN6VJC0OTWwQmIhnyX1/JAnZY8Knq9EPPVW6XOSxg+TsccXUUNBYQPK2DlM0dpGRmptJepQ61RHlr6G91V17l0sz9q3nHO+zhhCwQQfb0+ifZzQGk1B9CIlToxbdLDqHE0agI/qEGewD5Vb0cwGP+DzxLeSyxg1xDOiBQQQT1Z4sw/z4AqOxOaGO2I2V41KOuF5vKJD2ZIWgxgkb9QW9Tl/Bu8lvxWz1mX7oJyT8xsml/3EiOt6j7czzHl6QOUSG52zB4OaEuXO5NKwgK0UzYU+rVH9Ovxk67uNNu+Oxl99PiCiHr/K+PKa1k4kRpjzEskcVEsGysdSIPFxT9/J05+/5JDJXnvvZYd6riQJMDNPtTxiayBIRnHUuGL/8NkeoCRpIX/Z8tUqSguLa0M+ZCpQ3onkZ5KuRqx6CbYKhzOwQ6sQ0avmdtVHf6VuNpgCxQ4f1cn962d9LCnfhQyhjA2hbwka9mqhTlu06S15t07fdZTevB07b5xg5JzI75OssUnltPWNDSrfnErxGT6d7g+8YihakvE480uob6GjAo=
install:
- pip install -r requirements.txt
script:
- git clean -f -d -x
after_success:
- openssl aes-256-cbc -K $encrypted_0a58f67d178a_key -iv $encrypted_0a58f67d178a_iv
  -in o11y-workshop-deploy-key.enc -out o11y-workshop-deploy-key -d
- eval $(ssh-agent -s)
- chmod 600 o11y-workshop-deploy-key
- ssh-add ./o11y-workshop-deploy-key
- "./.ci/release.sh  || travis_terminate 1"
deploy:
  provider: script
  skip_cleanup: true
  script: "./.ci/deploy.sh"
  on:
    repo: signalfx/observability-workshop
    tags: true
