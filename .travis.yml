language: python
os: linux
dist: xenial
if: tag IS present
cache: pip
env:
  global:
  - secure: STcUCm9gddsXZVAPXJj53V2+a91elaiskoWRQXmuPXefWT2Zd5O3kM5SxDfcdbBCUi9UbcwnFPP6MnGZE5iO61A6qIUlmVJX3WuZdzSHqJ7er0pfEu6TI/Av8YuGi4m97RAq7t50a/iQIUVH+chLTh+iYGpVawSSZzIAqaLPBz9JFP/GSP1z1ocAgeiMkvLO7Izp1U8dWzAPnUPiuDbzYkHooKxOS0F6TTsAFnCHf5pfg+cEgKPCnw4O3XG2G8gV5xRLXexZwazRI2j/JX6jK6wNcjyvKZCN68Gy/+2MrQoYZmUWjPKVh7jOJ2v7Diw8/+DjOOAER4EpDwB8/45vTHjNOaRyzVcczBMMqXAYvXkUn1Dd8Dc7pYHDkm8d2enfdmkYmnMYVZb75Yc5KJ1RN6svU3LnkA2KpVN6gpIT9Lc8VF6CNCOIxAyemgCRX3JjAyyJz7R7ofDhqjVz5asxauB7cFja+HVRR2A06Wq92ie/EjlZ70JUdAHEywG1EA3tPd/eIRj2I/VQzrvOD+OLTY/eSNb6WOYmdKq6pbphMtR+jWdRgVa8RImfOfT0WGBh3Ml1MSnjHlQ53ccL39WobdU5vbak8KL62Vzdy/uMPrQAuJTBE/dvAFyJJicvmICrTIjmjlg1kTR5le9TMsRYwJ/hfiIbJikj/D0x3Y48Rmg=
  - secure: Znr+F2OTvGa+uX4abBBFA0vNpKkaovQ9dk3BS19s6F3Kf1vqTqAYPjxyE46b/zL940aXI/PvVe0oTx/lr76gxSHPzNpXiC1SmBjaCEcyAz0bL1g4bRP+SexwOYQ1BLWroIFrBPJTL8/8ZmlQ6v5opCCKFeEbpJ3N9uGEVJ7P4zKsy8Cbvgpv4oXmZAd6H53Ee0fY5BHMKsTYrzhjdKEvFyxYvuphlpKuaXuoFG34g1M28l1edwbDzUEkdZyK9NaX2Kgv0+wArFpUaj0LVYHSWKKfqlGV9Gs679klxVyFNlggRwuLmHSxd2hMEqi2m+as15c4ZOIyAxg7v5WwBH1MYwl8/hwJEVQMSTeCwpiolKTcg/km1EOaNzYTYg05nK7J93Ntblj3rZ2ZxmKkTw3QFmdRFl4JxNx053nBX405j+4r0iJQyp7hRNmD4ho772CVfl12XNdYAXm2ZSj/yARpq+TUSXy7AnFnXaER5J4CvQVH+ejiqZYwZY6fTimLMhlWETEKj8SbtspaZBCmiHp9VX/W0MLaL7MjJlk5Vo8rP5Ra2RoQ9eNI/Fref3XbyIUbS21gOF8kqxRvHdaHjfPhusmD3wWZ5B6+ofEa9jpt4XAzLy3e1w1Qoosd/wNWV9H8AuTZyN6dKPA2ccYkzQp9+S4bGqyUrqFX4OxLeVhhZXg=
install:
- pip install -r requirements.txt
script:
- git clean -f -d -x
after_success:
- openssl aes-256-cbc -K $encrypted_0a58f67d178a_key -iv $encrypted_0a58f67d178a_iv
  -in o11y-workshop-deploy-key.enc -out o11y-workshop-deploy-key -d
- eval $(ssh-agent -s)
- chmod 600 o11y-workshop-deploy-key
- ssh-add ./o11y-workshop-deploy-key
- "./.ci/release.sh  || travis_terminate 1"
deploy:
  provider: script
  skip_cleanup: true
  script: "./.ci/deploy.sh"
  on:
    repo: signalfx/observability-workshop
    tags: true
