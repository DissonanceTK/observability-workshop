language: python
os: linux
dist: xenial
if: tag IS present
cache: pip
env:
  global:
    secure: C8yUH9HCwwX25DxDrksHbvfzyjJmtdpO8hkLvRjGNO6y+CCINtIhwjxbyHqrvJe/16ssl1WCDpLzU8V4TaR/DKsc9RJcrrS2gczqtlh944LMj8zzllZ7luNqY0v6vEJ9ujgmuAE3WqqkmCA11E4aQP7VZcO3WmOpuIqgNauHidD61lyYWqTo5Ax91GXfUNq1LLJuY5a1Bof1pGOv1XDlnRcTxUMz2Veg0zu8zX9/tF9pl3F5e+LeYeuVikGLBCv2J34hG7SGMlL3rSCUU55a8yPuW7WK9n1gTzAoMKCkP/MoZkkfF8bvVr+iftUvOb1uXXFz7L9FErr3LeXNNiUoLBSh9E81IyyUR1hru6HRr0KuJn9YlzxK1XLyDgjROYFHnT46Q4ImtieTnOYleNc+Ik36OyVuCveJVb/nU1Y5L5igEnyTFZeWFeHPlTbPqc110ApMRSGfFmHGIojMlWOUsaEtx1Dx5lOSb3X/AI6zUwx9mhgy1/da3H6mXBMa08u8RzxM89meMcLo9JWjIMNx6hWgxy0bBalvPsbG66bw+d1S03AygCxm/Zfjnr3s+QYA0+bwJw+72GSkfJ8UtBRJj51g2VBJ+URYFo/h/cu5sG4O0YrHDdb+rNiQzIITUFXP4GhFLOz6bf+cUkLeT/TwRwQWkguk33Xf1D00aAfv/QQ=
install:
- pip install -r requirements.txt
script:
- git clean -f -d -x
after_success:
- openssl aes-256-cbc -K $encrypted_0a58f67d178a_key -iv $encrypted_0a58f67d178a_iv
  -in o11y-workshop-deploy-key.enc -out o11y-workshop-deploy-key -d
- eval $(ssh-agent -s)
- chmod 600 o11y-workshop-deploy-key
- ssh-add ./o11y-workshop-deploy-key
- "./.ci/release.sh  || travis_terminate 1"
deploy:
  provider: script
  skip_cleanup: true
  script: "./.ci/deploy.sh"
  on:
    repo: signalfx/observability-workshop
    tags: true
