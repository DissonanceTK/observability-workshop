language: python
os: linux
dist: xenial
if: tag IS present
cache: pip
env:
  global:
    secure: ebmS2+VsiTUoe2jFUVEuxP5lQs5JSllV2EdnPMDUarKGUEgLNH2dWqeKdIW0/UN75xssDjuux9A49o639PNXKC8Rt+XZR14eNYUSPqzis0KNXhA86vjDHZR1RefoAjJXlNrZfNEnX9O/diCRxqnbAUKo3Xdf0raCcIHXDKUZ7hR90NmH3AW0Pzm7p73CPl5EwiCN0mkTeD+fm8X+pIGeRW4uMPEqnbkYssjmXbzDFYuYbdAiG9vXDMg1YAOMNr5O/JCpJsIkQgTm8IWBGoW+NWc1oMHngQTGhwrx0nLGR109vY958FWHiYm6AsYgpNNxTSSvDg8zBkvqI+G3S1J1VeQA7qn9a8VtHm4IC/JjQlfl5nudYppvl3UQZk5VQpPEuSrDl9cefcyDQRXDckhj9vEgE6S+KZRFC8gDkoVgzDw9Ka5KHgdI33ChiGgROwyYY8BU6A7QHgJX0QBfjBNJHUAVNxsmlZG1WLUr4Uui3s76xFicWciMH/2ZjSVgkAyFfvLXjlKXhEmYT52xeolvdxtxtZl3BShJtMztx3KXDi/ABkv4NTiKy5L5zoUshlmHn8ZweKK841HlkJKk89B0X0O23XEeCICMKUAC5LBdwP3Civ6kC8k5YomwvOlZRnW9i6un5dr10OzxoXLkFc0wGS9fMXXC5C+Dn5kOCLXGw00=
install:
- pip install -r requirements.txt
script:
- git clean -f -d -x
after_success:
- openssl aes-256-cbc -K $encrypted_0a58f67d178a_key -iv $encrypted_0a58f67d178a_iv
  -in o11y-workshop-deploy-key.enc -out o11y-workshop-deploy-key -d
- eval $(ssh-agent -s)
- chmod 600 o11y-workshop-deploy-key
- ssh-add ./o11y-workshop-deploy-key
- "./.ci/release.sh  || travis_terminate 1"
deploy:
  provider: script
  skip_cleanup: true
  script: "./.ci/deploy.sh"
  on:
    repo: signalfx/observability-workshop
    tags: true
