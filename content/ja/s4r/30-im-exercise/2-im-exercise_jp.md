---
title: インフラストラクチャ演習 - パート2
linkTitle: パート2
weight: 2
---

{{% badge icon="clock" %}}10分{{% /badge %}}

これは、インフラモニタリング演習のパート2です。これで、単一のクラスタが表示されるはずです。

![Alt Cluster](../images/k8s-cluster.png)

* Kubernetes Navigatorでは、クラスタは黒い線で囲まれた四角形で表されます。
* それには、ノードまたはコンピュートエンジンを表す1つ以上の青い四角形が含まれます。
* それぞれがPodを表す1つまたは複数の色付きのボックスを含んでいます（これはサービスが実行される場所です）。
* そして、**緑**は健康を示し、**赤**は問題があることを示します。

2つの赤いボックスまたはタイルがあるので、何が起こっているか見て、これがオンラインブティックサイトに影響するかどうかを確認しましょう。

{{% notice title="演習" style="green" icon="running" %}}

* まず、作業する時間窓を最後の15分に変更します。これは、フィルタペインのTimeピッカーを**-4h**から**Last 15 minutes**に変更して行います。
* マウスをクラスタ、ノード、およびPod、**緑**と**赤**の両方の上に重ねます。
* 表示される情報パネルには、オブジェクトの状態が表示されます。**赤い**Podは**Pod Phase: Failed**であることが表示されます。これはクラッシュして機能していないことを意味します。
* クラスタに関するメトリクスチャートを調べてください（クラスタイメージの下にあるチャート）。これらはクラスタの健康状態に関する一般的な情報を提供します（メモリの消費量、ノードごとのポッドの数など）。
* クラッシュしたPodはKubernetesのパフォーマンスに影響を与えないため、**赤い**のポッドには何も表示されません。
* Spunk Kubernetes Analyzerがもっと有用な情報を提供できるかどうかを確認しましょう。**K8s Analyzer**をクリックします。
{{% notice title=" Spunk Kubernetes Analyzer" style="info" %}}

Splunk Kubernetes Analyzerは、Splunk Observability Cloudでバックグラウンドで実行されるスマートなプロセスであり、異常の間の関係を検出するように設計されています。

{{% /notice %}}

* **K8s Analyzer**は、2つの**赤い**ポッドが類似していることを検出しているはずで、それぞれの行の後に2が表示されています。また、同じ名前空間で実行されていることも示しています。
* K8sアナライザのビューで、どの名前空間かを見つけることができますか？（ヒント：`k8s.namespace.name`を探してみてください）。
* 次に、この問題がノードレベルでも発生しているかどうかを確認するために、最初にクラスタ上でマウスをホバリングさせ、左上に![青い三角形](../images/node-blue-traingle.png?classes=inline)が表示されるまで待ち、それをクリックします。
* これで、各ポッドに小さなボックスが表示されるはずで、これは実際のコードを実行するコンテナを表しています。*K8s Analyzer*は、この問題がノードレベルでも発生していることを確認するはずです。

![Analyser result](../images/k8s-analyser-result.png?width=20vw)

* **K8s node**をクリックします。これにより、ノードのメトリクスが表示され、チャートを調べると、開発名前空間には2つのポッドしかないことがわかります。
* フィルターペインで`k8s.namespace.name=development`にフィルタリングすると、**＃Total Pods**チャートには2つのポッドしか表示されず、**Node Workload**チャートには*test-job*しかなく、失敗していることがわかります。

{{% notice title="Spunk Kubernetes Analyzer" style="info" %}}

上記のシナリオは、チームが異なるステージでアプリケーションをデプロイする共有のKubernetes環境では一般的です。 Kubernetesは、これらの環境を完全に分離するように設計されています。

{{% /notice %}}

{{% /notice %}}

オンラインブティックサイトを構成するPodはすべてdevelopment名前空間では実行されておらず、他のすべてのポッドは緑です。したがって、これらのポッドは私たちに影響を与えないと安全に仮定し、次に進みましょう。
